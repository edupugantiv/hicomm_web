<h1>Key Screen 6: Group Page</h1>

<table width="100%">
	<tr>
		<td width="25%"> 
			Image Goes Here
		</td>
		<td width="25%">
			<%=@group.name%> <br />
			<%=@members.size%> member(s)<br />
			Scale: <%=@group.scale%> <br />
			Location: <%=@group.location%><br />
		</td>
		<td width="25%">
			Contact: <br/> 
			<%=link_to @group.group_leader.name, user_path(@group.group_leader)%> / Project Manager <br />
			<%=@group.group_leader.email%> / <%=@group.group_leader.mobile%><br />
		</td>
		<td width="25%">
			<%if can? :transfer_leadership, @group%> 
				<%=button_to "Manage Group", manage_group_path(@group), :method => 'get'%>
			<%elsif can? :leave, @group%>
				<%=button_to "Leave Group", leave_group_path(@group), data: {confirm: "Are you sure you want to leave #{@group.name}?"}, :method => 'put'%>
			<% else %> 
				<%=button_to "Join Group", join_group_path(@group), :method => 'put' %>
			<%end%>
		</td>
	</tr>
</table>
<hr> 
<table width="100%">
	<tr>
		<td width="25%">
			<%if can? :transfer_leadership, @group%>
				<%=button_to "Add Members", add_group_members_path(@group)%>
			<%end%>
			Members: <br />
			<%@members.each do |member| %> 
				<%=link_to member.name, user_path(member)%> <br />
			<%end%>
		</td>
		<td width="50%"> 
			Posts: <br />
			<%if @posts.empty? %> 
				<%=@group.name%> has no posts 
				<%=render partial: 'posts/new'%>
			<%else%> 
				<table width="80%" class="inbox" border="1"> 	
						<%@posts.each do |post| %> 
							<tr><td>
							<%=link_to post.poster.name, user_path(post.poster)%>: <%=post.body%> <br>
							<%=post.posted%>

							</td></tr>
						<%end%>
						 <tr><td><%= render partial: 'posts/new' %></td></tr>		
				</table>
			<%end%>
		</td>
		<td width = "25%"> 
			Affiliated Projects: <br />
			<%if @projects.empty? %> 
				<%=@group.name%> is not affiliated with any projects
			<%else%>
				<%@projects.each do |project| %> 
					<%=link_to project.name, project_path(:project_id => project, :conversation_id => project.conversations.first)%>
				<%end%>
			<%end%>
		</td>
	</tr>
</table>
